<!DOCTYPE html>
<html>
<head>
	<title>Tavern</title>
	<link href='http://fonts.googleapis.com/css?family=Sacramento|Homemade+Apple' rel='stylesheet' type='text/css'>
	<style>
		body, html{
			margin: 0;
			padding: 0;
			width: 100%;
			height: 100%;
			overflow: none;
		}
		body {
			background-color: #2c322b;
			color: #ffe6d4;
			font-family: 'Sacramento', cursive;
		}
		.papyrus {
			background-color: #EEDFA6;
			color: #20293F;
			font-family: 'Homemade Apple', cursive;
			border-radius: 5px;
		}
		.window {
			position: absolute;
			padding: 10px;
			top: 50%;
			left: 50%;
			margin-left: -200px;
			margin-top: -200px;
			width: 400px;
			height: 400px;
		}
		.sign {
			position: absolute;
			right: 20px;
			bottom: 20px;
			width: 150px;
			font-size: 10px;
			text-align: center;
			cursor: pointer;
		}
		.sign > .singature {
			overflow: hidden;
			position:absolute;
			padding-left: 10px;
			top: -15px;
			left: 50%;

			margin-left: -75px;
			width: 0;
			transition: all 0s linear;

			color: #8A0707;
			text-align: left;
			white-space: nowrap;
			font-size: 14px;
		}
		.sign:hover > .singature {
			width: 150px;
			transition: all 2s steps(50, end);
		}
		#Window {
			display: none;
		}
		#Curtain {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			opacity: 0.5;
			background-color: black;
			display: none;
		}
	</style>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<script>
	GAME = {
		curtain: null,
		papyrus: null,
		init: function(){
			this.curtain = $('#Curtain');
			this.papyrus = $('#Window');

			this.papyrus.children('div.sign').on('click', function(){
				console.log(this);
				this.papyrus.hide();
				this.curtain.hide();
			}.bind(this));

			for (var i = 0; i < 7; i++) {
				this.TIMER.put(i, Math.floor(Math.random() * 23) + 1);
			};
			console.log(this.TIMER);
			console.log(this.TIMER.next());
		},
		openWindow: function(content){
			console.log(this.curtain);
			this.curtain.show();
			this.papyrus.children('div.content').text(content);
			this.papyrus.show();
		},
		TIMER: {
			time: 0,
			events: ['New Day'],
			eventsTimes: [24],
			put: function(event, time){
				var indx = this.events.length;
				for (var i = 0; i < this.eventsTimes.length; i++) {
					if(this.eventsTimes[i] > time){
						indx = i;
						break;
					}
				};

				this.eventsTimes.splice(indx, 0, time);
				this.events.splice(indx, 0, event);
			},
			progress: function(){
				var ret = [];
				this.time++;
				for (var i = 0; i < this.eventsTimes.length; i++) {
					if(this.eventsTimes[i] <= this.time){
						ret.push(this.events[i]);
					}
				}
				this.eventsTimes.splice(0, ret.length);
				this.events.splice(0, ret.length);

				this.checkDay();
				return ret;
			},
			next: function(){
				var ret = [];
				do {
					ret = this.progress();
				} while(ret.length == 0)
				return ret;
			},
			checkDay: function(){
				if(this.time == 24){
					this.time = 0;
					this.events = ['New Day'];
					this.eventsTimes = [24];
				}
			},
		},
	}
	$(function(){
		GAME.init();
		//setInterval(function(){ console.log(GAME.TIMER.next(), GAME.TIMER.time) }, 2000);
	});
	</script>
</head>
<body>
	<div id="Curtain"></div>
	<div id="Window" class="window papyrus">
		<div class="content"></div>
		<div class="sign">
			Sign here
			<div class="singature">Sigfred Queltran</div>
		</div>
	</div>
</body>
</html>